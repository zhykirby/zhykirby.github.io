---
layout:     post
title:      Acorn源码分析(2)
subtitle:   
date:       2021-04-13
author:     zhykirby
header-img: img/post-bg-universe.jpg
catalog: true
tags:
    - acorn
    - 词法分析
    - 源码
---

## 前言

其实早就写了，只是一直没发，工作太忙，没空呀～  
上一篇链接——[Acorn源码分析(1)](https://zhykirby.github.io/2020/11/12/Acorn%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90(1)/)  
本篇将会分两次补全，现在是第一次～

## nextToken():acorn中的词法分析
词法分析说起来比较简单，拆分代码字符串，分成一个个单词，并根据拆分出来的事件和状态得到结果。

### token
token的意思我就不翻译了，这里介绍下token在acorn里的分类。在acorn里主要可以分为以下几种。

- kw:keyword 关键词
- name:普通名称
- binop:binary op 二进制运算符
- 符号类型
- eof:结束符

这里截个图展示下，大致就可以理解了。  
![image](https://user-images.githubusercontent.com/32432388/114433026-e8cc6680-9bf3-11eb-9682-104c7841d9a3.png)  
![image](https://user-images.githubusercontent.com/32432388/114433048-f08c0b00-9bf3-11eb-9f80-49b88946a0ba.png)  
![image](https://user-images.githubusercontent.com/32432388/114433077-f97cdc80-9bf3-11eb-8840-d376ecd02cc6.png)  
![image](https://user-images.githubusercontent.com/32432388/114433102-00a3ea80-9bf4-11eb-9da5-c873bbe9d183.png)  


acorn会将代码拆分成一个个单词，并根据type转化成一个个token，添加属性（位置，运算优先级等），方便用来词法分析。

### 词法状态机
说了token，就不得不说下词法状态机。毕竟代码的实现依赖于此。
acorn是写出来所有状态（token）再一步步走下去，这个是确定有限状态自动机

### 核心函数

从nextToken进去，核心部分主要是以下几个函数：

- nextToken
- readToken
- readWord
- getTokenFromCode

函数代码这里就不全放上来了，关于acorn源码的函数简化版本放在另一个文档，这里可以link过去。

首先说一下nextToken函数，这里挑一下重点说下。
```

```
